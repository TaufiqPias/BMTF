<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Taufiq Pias" />
    <title>R&R Flooring - BMT</title>
    <link rel="icon" type="image/x-icon" href="..\Images\Favicon.png" />
    <link rel="stylesheet" href="styles.css" />

    <script>
      (function () {
        const savedMode = localStorage.getItem("themeMode");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedMode === "dark" || (!savedMode && prefersDark)) {
          document.documentElement.classList.add("dark-mode"); // Changed to <html>
        }
        // Only collapse .info-content on mobile initially
        if (window.matchMedia("(max-width: 1200px)").matches) {
          document.querySelectorAll(".info-content").forEach((el) => {
            el.classList.add("collapsed");
          });
        }
      })();
    </script>

    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-M2K232X4B3"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-M2K232X4B3");
    </script>

    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "qj1sdmrlho");
    </script>
  </head>

  <body>
    <div class="main-container">
      <!-- Information Area -->
      <div class="info-container">
        <button class="toggle-btn">Toggle Information</button>
        <div class="info-content">
          <h2>Information</h2>
          <p>
            Fill out the form accordingly to generate a bid. The following
            prices are provided as a ranged parameter taken from RepairBase
            2024.
          </p>
          <p><b>Approximate Prices:</b></p>
          <table>
            <tr>
              <th>Item Name</th>
              <th>Unit per</th>
              <th>Prices</th>
            </tr>
            <tr>
              <td>Remove Carpet - Indoor/Outdoor - Demolition Only</td>
              <td>SF</td>
              <td>$0.65</td>
            </tr>
            <tr>
              <td>Remove Carpet & Pad - Dry</td>
              <td>SF</td>
              <td>$0.30</td>
            </tr>
            <tr>
              <td>Remove Carpet Tack Strip - From Wood Subfloor - Per LF</td>
              <td>LF</td>
              <td>$0.31</td>
            </tr>
            <tr>
              <td>Remove Discolored Wood Floor - Remove, Treat Subfloor, Seal</td>
              <td>SF</td>
              <td>$2.79</td>
            </tr>
            <tr>
              <td>Remove Floor - Vinyl - Demolition Only</td>
              <td>SF</td>
              <td>$0.64</td>
            </tr>
            <tr>
              <td>Remove Hardwood Floor - Glued Down - Demolition Only</td>
              <td>SF</td>
              <td>$1.69</td>
            </tr>
            <tr>
              <td>Remove Hardwood Floor - Nailed Down - Demolition Only</td>
              <td>SF</td>
              <td>$0.98</td>
            </tr>
            <tr>
              <td>Remove Laminate Floor - Demolition Only</td>
              <td>SF</td>
              <td>$0.46</td>
            </tr>
            <tr>
              <td>Remove Tile Floor - Ceramic - Demolition Only</td>
              <td>SF</td>
              <td>$0.64</td>
            </tr>
            <tr>
              <td>Remove Tile Floor - Natural Stone - Demolition Only</td>
              <td>SF</td>
              <td>$0.64</td>
            </tr>
            <tr>
              <td>---</td>
              <td>---</td>
              <td>---</td>
            </tr>
            <tr>
              <td>Replace Carpet Tack Strip</td>
              <td>LF</td>
              <td>$1.28</td>
            </tr>
            <tr>
              <td>Replace Carpet & Pad</td>
              <td>SF</td>
              <td>$1.34</td>
            </tr>
            <tr>
              <td>Replace Carpet (FHA Grade)</td>
              <td>SF</td>
              <td>$1.00</td>
            </tr>
            <tr>
              <td>Replace Deck Sheathing 3/4" CDX - Subfloor</td>
              <td>SF</td>
              <td>$4.52</td>
            </tr>
            <tr>
              <td>Replace Hardwood Floor Pre-Finished - Solid - Economy</td>
              <td>SF</td>
              <td>$12.12</td>
            </tr>
            <tr>
              <td>Replace Hardwood Floor Pre-Finished - Solid - Good</td>
              <td>SF</td>
              <td>$15.69</td>
            </tr>
            <tr>
              <td>Replace Hardwood Floor Pre-Finished - Veneer - Economy</td>
              <td>SF</td>
              <td>$8.38</td>
            </tr>
            <tr>
              <td>Replace Hardwood Floor Pre-Finished - Veneer - Good</td>
              <td>SF</td>
              <td>$11.21</td>
            </tr>
          </table>
          <p><b>For Subfloor:</b> Follow these steps - 
          <ul>
            <li>Remove Flooring (carpet, wood floor, vinyle floor or ceramic floor)</li>
            <li>Remove subfloor.</li>
            <li>Replace new subfloor.</li>
            <li>Replace new flooring.</li>
          </ul>
        </p>
          <b>
            <p style="color: brown">
              ***Consult with your Team Lead before submitting the price.***
            </p>
          </b>
          <b>
            <p style="color: brown">
              ***Please copy the bids before visiting other pages. Bids will not
              be saved once redirected.***
            </p>
          </b>
        </div>
      </div>

      <div class="container">
        <button class="toggle-btn">Toggle Form</button>
        <div class="division">
          <h1>Flooring Bid</h1>
          <h2>R&R Flooring Bids</h2>
          <form id="Form">
            <label for="bidPrefix"
              >Bid Prefix (for conjunction bid - Use a colon after
              prefix)</label
            >
            <input
              type="text"
              id="bidPrefix"
              name="bidPrefix"
              placeholder="Title: / Title-"
            />

            <label for="action">Select an Action:*</label>
            <select id="action" name="action" required>
              <option value="">--Select an Action--</option>
              <option value="remove">Remove</option>
              <option value="replace">Replace</option>
            </select>

            <label for="appl">Select Floor Type:*</label>
            <select id="appl" name="appl" required>
              <option value="">--Select any--</option>
              <option value="subfloor/floor sheathing">Subfloor</option>
              <option value="carpet">Carpet</option>
              <option value="wooden floor">Wooden Floor</option>
              <option value="laminated wood floor">Laminated Wood Floor</option>
              <option value="vinyle tiles floor">Vinyle Tiles</option>
              <option value="vinyle sheet floor">Vinyle Sheet</option>
              <option value="ceramic tiles floor">Ceramic Tiles</option>
            </select>

            <div id="countField" style="display: none">
              <label for="padding">Padding & Tackstrip Included?*</label>
              <select id="padding" name="padding">
                <option value="">--Select any--</option>
                <option value="yes">Yes</option>
                <option value="">No</option>
              </select>
            </div>

            <label for="length">Floor Length:*</label>
            <input type="number" id="length" name="length" step="1" required />

            <label for="width">Floor Width:*</label>
            <input type="number" id="width" name="width" step="1" required />

            <div id="debrisField" style="display: none">
              <label for="debris">Generated debris (in cyds):</label>
              <input type="number" id="debris" name="debris" step="1" />
            </div>

            <label for="loc">Location:*</label>
            <input
              type="text"
              id="loc"
              name="loc"
              placeholder="living room, bedroom, dining, den, etc."
              required
            />

            <label for="reason">Reason:</label>
            <input
              type="text"
              id="reason"
              name="reason"
              placeholder="damaged, wet, torn, etc"
            />

            <label for="additionalInfo">Additional information:</label>
            <textarea
              id="additionalInfo"
              name="additionalInfo"
              placeholder="Disclaimers or any other comment"
            ></textarea>

            <label for="conj">Make this bid conjunction to:</label>
            <input
              type="text"
              id="conj"
              name="conj"
              placeholder="Bid name only"
            />

            <label for="price">Price (in USD):</label>
            <input type="number" id="price" name="price" step="0.01" />

            <button type="submit">Generate Bid</button>
            <!-- <a href="https://www.zillow.com/" target="_blank" id="findpropsize">Find Property Size: Zillow</a> -->
            <!-- <a href="https://www.google.com/maps" target="_blank" id="measuredr">Plan & Measure French Drain</a> -->
          </form>
        </div>
      </div>

      <!-- New Note Section -->
      <div class="note-container">
        <h2>Bids</h2>
        <div id="notesList" class="notes-list">
          <!-- Notes will be dynamically added here -->
        </div>
        <button id="copyAllBidsButton">Copy All Bids</button>
        <a href="../index.html" id="home">
          <ion-icon name="home"></ion-icon> Go Home</a
        >
      </div>
    </div>

    <div id="floatingMessage" class="floating-message">Copied!</div>

    <!-- Script to Generate Bid -->
    <script>
      // Debris and other field visibility logic
      document.getElementById("action").addEventListener("change", function () {
        const action = this.value;
        const debrisField = document.getElementById("debrisField");
        const debrisInput = document.getElementById("debris");

        // Debris field visibility and reset
        if (action === "remove") {
          debrisField.style.display = "block";
        } else {
          debrisField.style.display = "none";
          debrisInput.value = ""; // Reset to default when hidden
        }
      });

      document.getElementById("appl").addEventListener("change", function () {
        const appl = this.value;
        const countField = document.getElementById("countField");
        const paddingSelect = document.getElementById("padding");

        // Padding field visibility and reset
        if (appl === "carpet") {
          countField.style.display = "block";
        } else {
          countField.style.display = "none";
          paddingSelect.value = ""; // Reset to default when hidden
        }
      });

      document
        .getElementById("Form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          // Get form values
          const bidPrefix = document.getElementById("bidPrefix").value;
          const length = parseFloat(document.getElementById("length").value);
          const width = parseFloat(document.getElementById("width").value);
          const action = document.getElementById("action").value;
          const appl = document.getElementById("appl").value;
          const countField = document.getElementById("countField");
          const padding =
            countField.style.display === "block"
              ? document.getElementById("padding").value
              : "";
          const reason = document.getElementById("reason").value;
          const loc = document.getElementById("loc").value;
          const debrisField = document.getElementById("debrisField");
          const debris =
            debrisField.style.display === "block"
              ? document.getElementById("debris").value
              : "";
          const additionalInfo =
            document.getElementById("additionalInfo").value;
          const conj = document.getElementById("conj").value;
          const price = parseFloat(document.getElementById("price").value || 0);

          // Validate numeric inputs
          if (isNaN(length) || isNaN(width) || length <= 0 || width <= 0) {
            alert("Please enter valid positive values for length and width.");
            return;
          }
          if (
            action === "remove" &&
            debrisField.style.display === "block" &&
            (!debris || debris <= 0)
          ) {
            alert("Please enter a valid positive value for debris.");
            return;
          }

          // Format the price with commas
          const formattedPrice = price.toLocaleString("en-US", {
            style: "decimal",
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          });

          // Generate the bid text
          let bidText;
          if (action === "remove") {
            bidText = `${bidPrefix} Need to remove approx ${length}x${width} = ${
              length * width
            } SF of ${appl} from the ${loc} of the property due to ${reason}. ${
              padding
                ? `This also includes ${length * width} SF of padding and ${
                    2 * length + 2 * width
                  } LF of tackstrip`
                : ""
            }. ${
              debris
                ? `Will generate approx ${debris} cyds of debris - hauling away included.`
                : ""
            } ${
              conj
                ? `***Must be approved in conjunction to ${conj} bid.***`
                : ""
            } ${additionalInfo}\nPrice: $${formattedPrice}`;
          } else if (action === "replace") {
            bidText = `${bidPrefix} Need to replace approx ${length}x${width} = ${
              length * width
            } SF of ${appl} in the ${loc} of the property due to ${reason}. ${
              padding
                ? `This also includes ${length * width} SF of padding and ${
                    2 * length + 2 * width
                  } LF of tackstrip`
                : ""
            }. ${
              conj
                ? `***Must be approved in conjunction to ${conj} bid.***`
                : ""
            } ${additionalInfo}\nPrice: $${formattedPrice}`;
          } else {
            alert("Please select an action (Remove or Replace).");
            return; // Stop execution if no action is selected
          }

          // Save the bid as a note
          saveBidAsNote(bidText);
        });
    </script>
    <script src="script_other.js"></script>
    <script src="..\dark_mode.js"></script>
    <script src="blocker.js"></script>
  </body>
</html>
