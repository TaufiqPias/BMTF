<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Taufiq Pias" />
    <title>Driveway - BMT</title>
    <link rel="icon" type="image/x-icon" href="..\Images\Favicon.png" />
    <link rel="stylesheet" href="styles.css" />
    <script>
      (function () {
        const savedMode = localStorage.getItem("themeMode");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedMode === "dark" || (!savedMode && prefersDark)) {
          document.documentElement.classList.add("dark-mode"); // Changed to <html>
        }
        // Only collapse .info-content on mobile initially
        if (window.matchMedia("(max-width: 1200px)").matches) {
          document.querySelectorAll(".info-content").forEach((el) => {
            el.classList.add("collapsed");
          });
        }
      })();
    </script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-M2K232X4B3"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-M2K232X4B3");
    </script>

    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "qj1sdmrlho");
    </script>
  </head>

  <body>
    <div class="main-container">
      <!-- Information Area -->
      <div class="info-container">
        <button class="toggle-btn">Toggle Information</button>
        <div class="info-content">
          <h2>Information</h2>
          <h3>Driveway Repair Types</h3>

          <h4>1. Asphalt Driveway Repairs</h4>
          <ul>
            <li>
              <b>Patching:</b> Filling potholes or cracks with asphalt patch
              material.
            </li>
            <li>
              <b>Sealcoating:</b> Applying a protective layer to prevent water
              damage and UV deterioration.
            </li>
            <li>
              <b>Crack Filling:</b> Sealing cracks to prevent water infiltration
              and further damage.
            </li>
            <li>
              <b>Resurfacing:</b> Applying a new layer of asphalt over the
              existing surface.
            </li>
            <li>
              <b>Overlay:</b> Adding a thick layer of asphalt to restore the
              driveway's surface.
            </li>
          </ul>

          <h4>2. Concrete Driveway Repairs</h4>
          <ul>
            <li>
              <b>Crack Repair:</b> Filling cracks with concrete caulk or epoxy.
            </li>
            <li>
              <b>Resurfacing:</b> Applying a thin layer of new concrete or
              overlay.
            </li>
            <li>
              <b>Mudjacking:</b> Lifting sunken concrete slabs by injecting a
              slurry underneath.
            </li>
            <li>
              <b>Polyurethane Foam Injection:</b> Similar to mudjacking but uses
              foam to lift and stabilize concrete.
            </li>
            <li>
              <b>Replacement:</b> Removing and replacing severely damaged
              sections.
            </li>
          </ul>

          <h4>3. Gravel Driveway Repairs</h4>
          <ul>
            <li>
              <b>Grading:</b> Leveling the driveway and redistributing gravel.
            </li>
            <li>
              <b>Adding New Gravel:</b> To replenish lost material and improve
              the surface.
            </li>
            <li>
              <b>Compacting:</b> Using a roller or tamper to stabilize the
              gravel.
            </li>
          </ul>

          <h4>4. Pavement Driveway Repairs</h4>
          <ul>
            <li>
              <b>Replacing Damaged Pavers:</b> Removing and replacing cracked or
              broken pavers.
            </li>
            <li><b>Releveling:</b> Adjusting sunken or uneven pavers.</li>
            <li>
              <b>Joint Sand Replacement:</b> Refilling the sand between pavers
              to stabilize them.
            </li>
          </ul>
          <b>
            <p style="color: brown">
              ***Consult with your Team Lead before submitting the price.***
            </p>
          </b>
          <b>
            <p style="color: brown">
              ***Please copy the bids before visiting other pages. Bids will not
              be saved once redirected.***
            </p>
          </b>
        </div>
      </div>

      <div class="container">
        <button class="toggle-btn">Toggle Form</button>
        <div class="division">
          <h1>Landscaping Bid</h1>
          <h2>Driveway Bids</h2>
          <form id="drForm">
            <label for="bidPrefix"
              >Bid Prefix (for conjunction bid - Use a colon after
              prefix)</label
            >
            <input
              type="text"
              id="bidPrefix"
              name="bidPrefix"
              placeholder="Title: / Title-"
            />

            <label for="drivewaytype">Select A Type of Driveway:*</label>
            <select id="drivewaytype" name="drivewaytype" required>
              <option value="">--Select a Type--</option>
              <option value="asphalt">Asphalt Driveway</option>
              <option value="concrete">Concrete Driveway</option>
              <option value="gravel">Gravel Driveway</option>
              <option value="pavement">Pavement Driveway</option>
            </select>

            <label for="repairtype">Repair Type:*</label>
            <select id="repairtype" name="repairtype" required>
              <option value="">Select Repair Type</option>
            </select>

            <label for="size">What is the size of the damage?*</label>
            <input
              type="text"
              id="size"
              name="size"
              placeholder="i.e.- 3 X 2 = 6 SF or 30 LF"
              required
            />

            <div id="description"></div>

            <label for="additionalInfo">Additional information:</label>
            <textarea
              id="additionalInfo"
              name="additionalInfo"
              placeholder="Disclaimers or any other comment"
            ></textarea>

            <label for="conj">Make this bid conjunction to:</label>
            <input
              type="text"
              id="conj"
              name="conj"
              placeholder="Bid name only"
            />

            <label for="price">Price (in USD):</label>
            <input type="number" id="price" name="price" step="0.01" />

            <button type="submit">Generate Bid</button>
          </form>
        </div>
      </div>

      <!-- New Note Section -->
      <div class="note-container">
        <h2>Bids</h2>
        <div id="notesList" class="notes-list">
          <!-- Notes will be dynamically added here -->
        </div>
        <button id="copyAllBidsButton">Copy All Bids</button>
        <a href="../index.html" id="home">
          <ion-icon name="home"></ion-icon> Go Home</a
        >
      </div>
    </div>

    <div id="floatingMessage" class="floating-message">Copied!</div>

    <!-- Script for Dynamic Option -->
    <script>
      const drivewayTypeDropdown = document.getElementById("drivewaytype");
      const repairTypeDropdown = document.getElementById("repairtype");
      const descriptionDiv = document.getElementById("description");

      // Define repair types for each driveway type
      const repairTypes = {
        asphalt: [
          "Patching",
          "Sealcoating",
          "Crack Filling",
          "Resurfacing",
          "Overlay",
        ],
        concrete: [
          "Crack Repair",
          "Resurfacing",
          "Mudjacking",
          "Polyurethane Foam Injection",
          "Replacement",
        ],
        gravel: ["Grading", "Adding New Gravel", "Compacting"],
        pavement: [
          "Replacing Damaged Pavers",
          "Releveling",
          "Joint Sand Replacement",
        ],
      };

      // Define descriptions for each repair type
      const descriptions = {
        patching:
          "Will fill the damaged area (potholes or cracks) with asphalt patch.",
        sealcoating:
          "Will apply a protective layer of asphalt emulsion or similar product to prevent water damage and UV deterioration.",
        "crack-filling":
          "Will seal the cracks using asphalt/epoxy/mortar to prevent water infiltration and further damage.",
        resurfacing:
          "Will apply a new layer of asphalt over the existing surface.",
        overlay:
          "Will add a thick layer of asphalt to restore the driveway's surface.",
        "crack-repair": "Will fill cracks with concrete caulk or epoxy.",
        mudjacking:
          "Will lift sunken concrete slabs by injecting a slurry (a mixture of water, soil, and cement) underneath.",
        "polyurethane-foam-injection":
          "Will lift sunken concrete slabs by injecting a foam to lift and stabilize concrete.",
        replacement: "Will remove and replace severely damaged sections.",
        grading: "Will level the driveway and redistribute the gravel.",
        "adding-new-gravel":
          "Will add new gravel to replenish lost material and improve the surface.",
        compacting: "Will use a roller or tamper to stabilize the gravel.",
        "replacing-damaged-pavers":
          "Will remove and replace cracked or broken pavers.",
        releveling: "Will adjust sunken or uneven pavers.",
        "joint-sand-replacement":
          "Will refill the sand between pavers to stabilize them.",
      };

      // Event listener for driveway type dropdown
      drivewayTypeDropdown.addEventListener("change", function () {
        const selectedDrivewayType = drivewayTypeDropdown.value;

        // Clear the repair type dropdown and description
        repairTypeDropdown.innerHTML =
          '<option value="">Select Repair Type</option>';
        descriptionDiv.textContent = "";

        // Populate the repair type dropdown based on the selected driveway type
        if (selectedDrivewayType && repairTypes[selectedDrivewayType]) {
          repairTypes[selectedDrivewayType].forEach(function (repairType) {
            const option = document.createElement("option");
            option.value = repairType.toLowerCase().replace(/ /g, "-");
            option.textContent = repairType;
            repairTypeDropdown.appendChild(option);
          });
        }
      });

      // Event listener for repair type dropdown
      repairTypeDropdown.addEventListener("change", function () {
        const selectedRepairType = repairTypeDropdown.value;

        // Display the description for the selected repair type
        if (selectedRepairType && descriptions[selectedRepairType]) {
          descriptionDiv.textContent = descriptions[selectedRepairType];
        } else {
          descriptionDiv.textContent = "";
        }
      });
    </script>

    <!-- Script to Generate Bid -->
    <script>
      document
        .getElementById("drForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          // Get form values
          const bidPrefix = document.getElementById("bidPrefix").value;
          const drivewaytype = document.getElementById("drivewaytype").value;
          const repairtype = document.getElementById("repairtype").value;
          const description =
            document.getElementById("description").textContent;
          const size = document.getElementById("size").value;
          const additionalInfo =
            document.getElementById("additionalInfo").value;
          const conj = document.getElementById("conj").value;
          const price = parseFloat(document.getElementById("price").value || 0);

          // Format the price with commas
          const formattedPrice = price.toLocaleString("en-US", {
            style: "decimal",
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          });

          // Generate the bid text
          const bidText = `${bidPrefix} Need to repair ${size} of ${drivewaytype} driveway using ${repairtype} method. ${description} ${
            conj ? `***Must be approved in conjunction to ${conj} bid.***` : ""
          } ${additionalInfo}\nPrice: $${formattedPrice}`;
          // Save the bid as a note
          saveBidAsNote(bidText);
        });
    </script>
    <script src="blocker.js"></script>
    <script src="..\dark_mode.js"></script>

    <script src="script_other.js"></script>
  </body>
</html>
